from scapy.all import ARP, Ether, srp

def scan_network(target_ip):
    """Scans the network for connected devices."""
    # Create an ARP request packet
    arp_request = ARP(pdst=target_ip)
    ether = Ether(dst="ff:ff:ff:ff:ff:ff")  # Broadcast packet
    packet = ether / arp_request

    # Send the packet and receive responses
    answered, _ = srp(packet, timeout=2, verbose=False)

    print("Devices Found:")
    print("IP Address\tMAC Address")
    print("-" * 40)

    for sent, received in answered:
        print(f"{received.psrc}\t{received.hwsrc}")

# Example usage: Scan your local network
scan_network("192.168.1.1/24")
